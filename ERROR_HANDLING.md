# ๐ด ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก - ุดุฑุญ ุดุงูู

## ๐ ููุฎุต ุณุฑูุน

ุชู ุชุญุณูู ูุธุงู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุฌุนู ุงูุฑุณุงุฆู **ูุฎุชุตุฑุฉ ููุงุถุญุฉ** ููุนูููุ ูุน ุงูุงุญุชูุงุธ ุจู Stack Trace ููุชุทููุฑ.

---

## ๐ฏ ูุง ุชู ุชุญุณูููุ

### 1๏ธโฃ **ุฑุณุงูุฉ ุงูุฎุทุฃ ูุจู ุงูุชุญุณูู:**
```
[2026-02-04T14:16:56.745Z] ERROR: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู - POST /api/auth/register
Stack trace: Error: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู
    at AuthService.register (file:///C:/Users/blals/OneDrive/.../auth.service.js:15:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async file:///C:/Users/blals/OneDrive/.../auth.controller.js:16:22
```
โ ุทูููุฉ ุฌุฏุงู ูุชุญุชูู ุนูู ูุนูููุงุช ุญุณุงุณุฉ

### 2๏ธโฃ **ุฑุณุงูุฉ ุงูุฎุทุฃ ุจุนุฏ ุงูุชุญุณูู:**

#### ููุนููู (JSON Response):
```json
{
  "status": "fail",
  "message": "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู"
}
```
โ ูุฎุชุตุฑุฉ ููุงุถุญุฉ ููุท

#### ูู ุงูู Console (Server Logs):
```
[2026-02-04T14:16:56.745Z] ERROR: [400] ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู - POST /api/auth/register

๐ด Stack Trace: Error: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู
    at AuthService.register (...)
```
โ ูุนูููุงุช ูุงููุฉ ูููุทูุฑูู ููุท

---

## ๐ง ููู ูุนูู ุงููุธุงูุ

### ูุณุงุฑ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:

```
1. ุญุฏูุซ ุฎุทุฃ ูู ุงูุฎุฏูุฉ
   โ
2. ุฑูุน AppError ูุน ุงูุฑุณุงูุฉ ูุงูููุฏ
   โ
3. Logger ูุณุฌู ุงูุฎุทุฃ ูุฎุชุตุฑุงู
   โ
4. globalErrorHandler ูุณุชูุจู ุงูุฎุทุฃ
   โ
5. ูู ุงูุชุทููุฑ: ูุทุจุน Stack Trace ูู Console
   โ
6. ูุฑุณู ุฑุณุงูุฉ ูุฎุชุตุฑุฉ ููุนููู ููุท
   โ
7. ูู ุงูุฅูุชุงุฌ: ุฑุณุงูุฉ ุนุงูุฉ ุฅุฐุง ูุงู ุงูุฎุทุฃ ุบูุฑ ุนูููุงุชู
```

---

## ๐ ุงููููุงุช ุงููุดุงุฑููุฉ

### 1. `utils/AppError.js` - ุชุนุฑูู ุงูุฃุฎุทุงุก
```javascript
new AppError('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู', 400);

// ุงููุชูุฌุฉ:
// - message: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู
// - statusCode: 400
// - status: 'fail' (ูุฃู ุงูููุฏ ูุจุฏุฃ ุจู 4)
// - isOperational: true (ุฎุทุฃ ุชุทุจููู ุทุจูุนู)
```

### 2. `utils/logger.js` - ุชุณุฌูู ุงูุฃุฎุทุงุก
```javascript
Logger.error(message);

// ุงูุชุญุณููุงุช:
โ ุชูุทูุน ุงูุฑุณุงุฆู ุงูุทูููุฉ (ุฃูุซุฑ ูู 200 ุญุฑู)
โ ุฅุถุงูุฉ ุงูู timestamp
โ ุฅุถุงูุฉ ูุณุชูู ุงูุฎุทูุฑุฉ (ERROR, INFO, WARN)
```

### 3. `middleware/errorHandler.js` - ูุนุงูุฌุฉ ููุงุฆูุฉ
```javascript
// ูู ุจูุฆุฉ ุงูุชุทููุฑ:
- ูุทุจุน Stack Trace ูู Console
- ูุฑุณู ุฑุณุงูุฉ ุงูุฎุทุฃ ูุงููุฉ ููุนููู

// ูู ุงูุฅูุชุงุฌ:
- ูุง ูุทุจุน Stack Trace
- ูุฑุณู ุฑุณุงูุฉ ุนุงูุฉ ุฅุฐุง ูู ุชูู operational
```

---

## ๐ ุงููุฑููุงุช ุจูู ุจูุฆุงุช ุงูุชุทููุฑ ูุงูุฅูุชุงุฌ

### ุจูุฆุฉ ุงูุชุทููุฑ (Development)

**ุงููุฏุฎูุงุช:**
```javascript
throw new AppError('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู', 400);
```

**ุงูู Console:**
```
[2026-02-04T14:16:56.745Z] ERROR: [400] ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู - POST /api/auth/register
๐ด Stack Trace: Error: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู
    at AuthService.register (...)
    at async AuthController.register (...)
```

**ุงูุงุณุชุฌุงุจุฉ ููุนููู:**
```json
{
  "status": "fail",
  "message": "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู"
}
```

---

### ุจูุฆุฉ ุงูุฅูุชุงุฌ (Production)

**ุงูู Console:**
```
[2026-02-04T14:16:56.745Z] ERROR: [400] ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู - POST /api/auth/register
(ุจุฏูู Stack Trace)
```

**ุงูุงุณุชุฌุงุจุฉ ููุนููู:**
```json
{
  "status": "fail",
  "message": "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู"
}
```

---

## โ ุฃูุถู ุงูููุงุฑุณุงุช

### โ ุงูุทุฑููุฉ ุงูุตุญูุญุฉ - ุฑูุน ุฃุฎุทุงุก ูุงุถุญุฉ:
```javascript
if (userExists) {
    throw new AppError('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู', 400);
}
```

### โ ุชุฌูุจ ูุฐุง - ุฑูุน ุฃุฎุทุงุก ุบุงูุถุฉ:
```javascript
throw new Error('ุฎุทุฃ ูู ุงูุญูุธ');  // ุบูุฑ ูุงุถุญ ููุนููู
```

### โ ุชุฌูุจ ูุฐุง - ุทุจุงุนุฉ ูุจุงุดุฑุฉ:
```javascript
console.error(err.stack);  // ููุถุญ ูุนูููุงุช ุงููุธุงู
```

---

## ๐ฏ ุฃููุงุท ุฑุณุงุฆู ุงูุฃุฎุทุงุก ุงูููุตู ุจูุง

| ุงููููู | ุงูููุฏ | ุงูุฑุณุงูุฉ |
|--------|------|--------|
| ุจุฑูุฏ ูุณุชุฎุฏู | 400 | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู |
| ุจูุงูุงุช ูุงูุตุฉ | 400 | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุทููุจ |
| ุนุฏู ุงูุชูููุถ | 401 | ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู |
| ุงููุตูู ูุฑููุถ | 403 | ููุณ ูุฏูู ุตูุงุญูุงุช ูุงููุฉ |
| ุบูุฑ ููุฌูุฏ | 404 | ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏ |
| Rate Limit | 429 | ุชู ุชุฌุงูุฒ ุญุฏ ุงูุทูุจุงุช |
| ุฎุทุฃ ุงูุฎุงุฏู | 500 | ุญุฏุซ ุฎุทุฃ ูู ุงูุฎุงุฏู |

---

## ๐ ูุซุงู ุนููู ูุงูู

### ุงูุณููุงุฑูู: ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ ูุน ุจุฑูุฏ ููุฌูุฏ

**ุงูุทูุจ:**
```bash
POST /api/auth/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "123456"
}
```

**ุงูููุฏ ูู `auth.service.js`:**
```javascript
async register(email, password) {
    const userExists = await User.findOne({ email });
    
    if (userExists) {
        throw new AppError('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู', 400);
    }
    
    // ... ุฅูุดุงุก ุงููุณุชุฎุฏู
}
```

**ูู ุงูู Console (Server):**
```
[2026-02-04T14:16:56.745Z] ERROR: [400] ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู - POST /api/auth/register
๐ด Stack Trace: Error: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู
    at AuthService.register (file:///...auth.service.js:15:19)
    at async AuthController.register (file:///...auth.controller.js:16:22)
```

**ุงูุงุณุชุฌุงุจุฉ ููุนููู (JSON):**
```json
HTTP/1.1 400 Bad Request

{
  "status": "fail",
  "message": "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู"
}
```

โ **ูุฎุชุตุฑุฉ ููุงุถุญุฉ ููุง ุชูุถุญ ุชูุงุตูู ุงููุธุงู**

---

## ๐ ุงูููุงุฆุฏ

| ุงููุงุฆุฏุฉ | ุงููุตู |
|--------|-------|
| **ุฃูุงู** | ูุง ุชููุถุญ ูุนูููุงุช ุญุณุงุณุฉ ููุนููู |
| **ูุถูุญ** | ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ููุฎุชุตุฑุฉ |
| **ูุงุจููุฉ ุงูุชุทููุฑ** | ูุนูููุงุช ูุงููุฉ ูู ุงูู logs ูููุทูุฑูู |
| **ุงูุงุญุชุฑุงููุฉ** | ุงุณุชุฌุงุจุงุช ููุญุฏุฉ ูุจุชูุณูู JSON |
| **ุงูุตูุงูุฉ** | ุณูููุฉ ุชุชุจุน ุงูุฃุฎุทุงุก ูุงููุดุงูู |

---

## ๐ ุงูุฏุนู

ูููุฒูุฏ ูู ุงูุชูุงุตููุ ุฑุงุฌุน:
- `middleware/errorHandler.js` - ูุนุงูุฌ ุงูุฃุฎุทุงุก
- `utils/AppError.js` - ุชุนุฑูู ุงูุฃุฎุทุงุก
- `utils/logger.js` - ูุธุงู ุงูุชุณุฌูู
